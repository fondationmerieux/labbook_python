{% extends "skeleton.html" %}

{% block head %}
{{ super() }}
    <title>{{ _('Accueil') }}</title>
{% endblock %}

{% block content %}
<div id="content">
    <div class="inner">
        <div id="main" style="opacity: 1;">
            <h2 class="page-title page-title-{{ session['user_role']|safe }}"><span>{{ _('Accueil') }}</span></h2>

            {% if session['user_role'] == 'A' %}
            <div class="module">
                <div class="links">
                    <a href="{{ session['server_ext'] }}/{{ session['redirect_name'] }}/setting-users/" class="list-group-item admin-crea-profil">{{ _("Gestion des utilisateurs") }}</a>
                    <!--<a href="#" class="list-group-item admin-gest-role">{{ _("Gestion des rôles") }}</a>-->
                    <a href="{{ session['server_ext'] }}/{{ session['redirect_name'] }}/setting-pref/" class="list-group-item admin-preferences">{{ _("Préférences") }}</a>
                    <a href="#" class="list-group-item admin-referentiel">{{ _("Réferentiel") }}</a>
                    <a href="{{ session['server_ext'] }}/{{ session['redirect_name'] }}/setting-report/" class="list-group-item admin-conf-cr">{{ _("Configuration des comptes-rendu") }}</a>
                    <a href="{{ session['server_ext'] }}/{{ session['redirect_name'] }}/setting-rec-num/" class="list-group-item admin-num-doss">{{ _("Configuration des numéros de dossier") }}</a>
                    <a href="#" id="pref_bill" onclick="change_pref('facturation');" class="list-group-item admin-gest-fact-{{ args['pref_bill'] }}">{{ _("Gestion de la Facturation") }}</a>

                    <a href="#" id="pref_quality" onclick="change_pref('qualite', {{ args['pref_quality'] }});" class="list-group-item admin-qualite-{{ args['pref_quality'] }}">{{ _("Management de la Qualité") }}</a>
                </div>
            </div>
            {% elif  session['user_role'] == 'B' %}
            <div class="module">
                <div class="links">
                    <a href="#" class="list-group-item f-list-bio">{{ _("Liste des dossiers") }}</a>
                    <a href="#" class="list-group-item b-list-bio">{{ _("Liste de travail biologiste") }}</a>
                    <a href="#" class="list-group-item prel-bio">{{ _("Etat des prélèvements en cours") }}</a>
                    <a href="#" class="list-group-item res-bio">{{ _("Saisie des résultats") }}</a>
                    <a href="#" class="list-group-item home-qualite">{{ _("Management de la Qaulité") }}</a>
                </div>
            </div>
            <div class="home-stat row">
                <div class="home-graph col-md-6">
                    <h3>Validations à effectuer</h3>
                    TODO IMG GRAPH
                </div>
                <div class="home-activity col-md-6">
                    <h3>Activité du laboratoire</h3>
                    <ul>
                        <li>Dernier numéro utilisé : <strong><span class="num-dos">TODO</span></strong></li>
                        <li>Nombre de dossiers validés aujourd'hui : <strong>TODO</strong></li>
                        <li>Nombre de dossiers enregistrés : <strong>TODO</strong></li>
                    </ul>
                </div>
            </div>
            {% elif  session['user_role'] == 'T' %}
            <div class="module">
                <div class="links">
                    <a href="#" class="list-group-item f-list-tec">Liste des dossiers</a>
                    <a href="#" class="list-group-item t-list-tec">Liste de travail technicien</a>
                    <a href="#" class="list-group-item prel-tec">Etat des prélèvements en cours</a>
                    <a href="#" class="list-group-item res-tec">Saisie des résultats</a>
                </div>
            </div>
            <div class="home-stat row">
                <div class="home-graph col-md-6">
                    <h3>Validations à effectuer</h3>
                    TODO IMG GRAPH
                </div>
                <div class="home-activity col-md-6">
                    <h3>Activité du laboratoire</h3>
                    <ul>
                        <li>Dernier numéro utilisé : <strong><span class="num-dos">TODO</span></strong></li>
                        <li>Nombre de dossiers validés aujourd'hui : <strong>TODO</strong></li>
                        <li>Nombre de dossiers enregistrés : <strong>TODO</strong></li>
                    </ul>
                </div>
            </div>
            {% elif  session['user_role'] == 'S' %}
            <div class="module">
                <div class="links">
                    <a href="#" class="list-group-item f-list-sec">Liste des dossiers</a>
                    <a href="#" class="list-group-item new-dos-ext-sec">Nouvelle demande externe</a>
                    <a href="#" class="list-group-item new-dos-int-sec">Nouvelle demande hospitalisé</a>
                </div>
            </div>
            <div class="home-stat row">
                <div class="home-graph col-md-6">
                    <h3>Validations à effectuer</h3>
                    TODO IMG GRAPH
                </div>
                <div class="home-activity col-md-6">
                    <h3>Activité du laboratoire</h3>
                    <ul>
                        <li>Dernier numéro utilisé : <strong><span class="num-dos">TODO</span></strong></li>
                        <li>Nombre de dossiers validés aujourd'hui : <strong>TODO</strong></li>
                        <li>Nombre de dossiers enregistrés : <strong>TODO</strong></li>
                    </ul>
                </div>
            </div>
            {% endif %}

        </div>
    </div>
</div><!-- ferme le corps -->
{% endblock %}

{% block add_script %}
<script>
var val_bill    = {{ args['pref_bill'] }} ;
var val_quality = {{ args['pref_quality'] }} ;

function change_pref(pref_name)
{
let prec_val = val_bill ;    
let val      = 0 ;
let ico      = "admin-gest-fact-" ;

    if (pref_name == "qualite")
    {
    prec_val = val_quality ;
    ico      = "admin-qualite-" ;
    }

    if (prec_val == 0)
    val = 1 ;

    if (pref_name == "qualite")
    val_quality = val ;
    else
    val_bill = val ;

    $.ajax( {
       type: "POST",
       url: "/services/default/name/" + pref_name + "/val/" + val,
       success: function(data)
           {
           console.log("SUCCESS POST change pref") ;
           $("." + ico + prec_val).addClass(ico + val) ;
           $("." + ico + val).removeClass(ico + prec_val) ;
           },
       error: function(data)
           {
           console.log("ERROR POST change pref") ;
           alert("{{ _("Une erreur est survenue lors de l'enregistrement") }}") ;
           }
    } ) ;
}
</script>
{% endblock %}
